---
title: "å‡½æ•°é—­åŒ…ä¸å›è°ƒ"
---

## ä¸€ç­‰å…¬æ°‘(First Class Citizens)

- å‡½æ•°å¯ä»¥èµ‹å€¼ç»™å˜é‡  `var stuff = function() {}`
    
- å‡½æ•°ä½œä¸ºå‡½æ•°å½¢å‚
- å‡½æ•°ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼

## é—­åŒ…çš„è§£é‡Š

> ğŸ§‘ğŸ»â€ğŸ’» A closure is when an outer function returns an inner function, the inner function is then executed in a different scope, and the inner function continues to maintain access to the outer function's variables, even though the outer function no longer exists.



```javascript
funcion callMeMaybe() {
	setTimeout(function() {
		console.log(calMe);
	}, 4000);
	const callMe = 'Hi! I am now here!';
}
```

```javascript
function compute(type, a, b) {
	compute.plus = function(a,b) {
        return a+b;
    }
    compute.minus = function(a,b) {
        return a-b;
    }
    compute.div = function(a,b) {
        return a/b;
    }
    compute.mul = function(a,b) {
        return a*b;
    }
    return compute[type](a,b);
}
```

## é—­åŒ…çš„å¥½å¤„
`heavyDuty` æ¯è°ƒç”¨ä¸€æ¬¡å°±ä¼šæ‰“å°ä¸€æ¬¡, `getHeavyDuty` åªä¼šè°ƒç”¨ä¸€æ¬¡
```javascript
function heavyDuty(item) {
  const bigArray = new Array(7000).fill('ğŸ˜„')
  console.log('created!');
  return bigArray[item]
}

heavyDuty(699)
heavyDuty(699)
heavyDuty(699)
const getHeavyDuty = heavyDuty2();
getHeavyDuty(699)
getHeavyDuty(699)
getHeavyDuty(699)

// but i dont want to pollute the global namespace..
function heavyDuty2() {
  const bigArray = new Array(7000).fill('ğŸ˜„')
  console.log('created Again!')
  return function(item) {
    return bigArray[item]
  }
}
```


## é—­åŒ…æ¨¡æ‹Ÿç§æœ‰åŒ–(encapsulation)

- ä¸¤ç§å†™æ³•(ä»…ä»…å¯¹å¤–æš´éœ²å‡ºæ–¹æ³•ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®å…¶å˜é‡)

<div className="grid grid-cols-2 gap-4">
  <div>

    ```javascript
    var Compute = (function () {
        var a = 100;

        class Compute {
            add(b) {
                return a + b;
            }
        }
        return Compute;
    })();

    var c = new Compute();
    console.log(c.a);       // undefined
    console.log(c.add(200)) //300
    ```
  </div>
  <div>

    ```javascript
    ;(function () {
        var a = 100;

        function Compute() {};
        Compute.prototype.add = function(b) {
          return a + b;
        }
        
        window.Compute = Compute;
    })();

    var c = new Compute();
    console.log(c.a);       // undefined
    console.log(c.add(200)) //300
    ```
  </div>
</div>




- å†…éƒ¨ç”¨å…³é”®å­—å®šä¹‰å˜é‡
<div className="grid grid-cols-2 gap-4">
  <div>
  ```javascript
  function Comput() {
    var a = 100;
    this.add = function(b) {
      return a+b;
    }
  }
  var c = new Comput();
  console.log(c.a);//undefined
  ```
  </div>
  <div>
    ```javascript
    function Comput() {
      this.a = 100;
      this.add = function(b) {
        return a+b;
      }
    }
    var c = new Comput();
    console.log(c.a);//100
    ```
  </div>
</div>

## Example: Using a Closure in an init function to ensure that the function is only executed once

```javascript
const init = () => {
  let initialized = false;

  return () => {
    if (initialized) {
      return console.warn('âš ï¸ init function already called, not initializing');
    }

    initialized = true;
    return console.info('initialized ğŸš€');
	 };
};
const initialize = init();

initialize();
initialize();
initialize();
```

## Reference

[Javascript Closures Made Easy](https://www.humankode.com/javascript/javascript-closures-made-easy/)